<% content_for :title, 'フォトスポット詳細' %>
<div  data-controller="image-modal">
  <div class="max-w-2xl w-full mx-auto py-8">
    <% if notice.present? %>
      <p class="py-2 px-3 bg-green-50 mb-5 text-green-600 font-medium rounded-md text-center" id="notice"><%= notice %></p>
    <% end %>
    <h1 class="font-bold text-3xl mb-6">フォトスポット詳細</h1>
    <%= render partial: 'photo_spot', locals: { photo_spot: @photo_spot } %>
    <% if @photo_spot.images.attached? %>
      <div class="flex flex-wrap gap-2 mt-2 md:mt-0 md:flex-shrink-0">
        <% @photo_spot.images.each_with_index do |img, index| %>
          <div class="cursor-pointer" data-action="click->image-modal#open"
            data-image-modal-index-value="<%= index %>"
            data-image-modal-images-value="<%= @photo_spot.images.map { |i| url_for(i) }.to_json %>">
            <%= image_tag img.variant(resize_to_limit: [120, 120]), class: "rounded shadow border w-24 h-24 object-cover", alt: @photo_spot.name %>
          </div>
        <% end %>
      </div>
    <% else %>
      <div class="no-photo">
        <p>写真がありません</p>
      </div>
    <% end %>
    <div class="mt-8 flex gap-2">
      <%= link_to '編集', edit_admin_photo_spot_path(@photo_spot), class: "rounded-md px-4 py-2 bg-yellow-100 hover:bg-yellow-200 text-yellow-800 font-medium" %>
      <%= link_to '一覧に戻る', admin_photo_spots_path, class: "rounded-md px-4 py-2 bg-gray-100 hover:bg-gray-200 text-gray-800 font-medium" %>
      <%= button_to '削除', admin_photo_spots_path(@photo_spot), method: :delete, form_class: "inline-block", class: "rounded-md px-4 py-2 bg-red-600 hover:bg-red-500 text-white font-medium", data: { turbo_confirm: '本当に削除しますか？' } %>
    </div>
    <%# モーダルウィンドウのHTML部分 %>
    <div data-image-modal-target="modal"
    class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-75 hidden">
      <div class="relative w-full h-full max-w-5xl">
        <div class="relative w-full h-full flex items-center justify-center">
          <img data-image-modal-target="image" class="max-w-full max-h-screen object-contain" alt="Enlarged image">
          <%# 閉じるボタン %>
          <button data-action="click->image-modal#close" class="absolute top-4 right-4 text-white text-4xl">
            &times;
          </button>
          <%# 左右の矢印ボタン %>
          <button data-action="click->image-modal#previous" data-image-modal-target="prevBtn" class="absolute left-4 top-1/2 -translate-y-1/2 text-white text-5xl">
            &lsaquo;
          </button>
          <button data-action="click->image-modal#next" data-image-modal-target="nextBtn" class="absolute right-4 top-1/2 -translate-y-1/2 text-white text-5xl">
            &rsaquo;
          </button>
        </div>
      </div>
    </div>
  </div>
</div>