<%= form_with(model: [:admin, photo_spot || @photo_spot], html: { multipart: true, class: "space-y-6", data: { controller: "map" } }) do |form| %>
  <% if photo_spot.errors.any? %>
    <div id="error_explanation" class="bg-red-50 text-red-500 px-3 py-2 font-medium rounded-md mt-3">
      <h2><%= pluralize(photo_spot.errors.count, "‰ª∂„ÅÆ„Ç®„É©„Éº") %>„Åå„ÅÇ„Çä„Åæ„Åô:</h2>
      <ul class="list-disc ml-6">
        <% photo_spot.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>
  <div>
    <%= form.label :name, 'ÂêçÁß∞', class: 'block font-semibold mb-1' %>
    <%= form.text_field :name, class: "block shadow-sm rounded-md border px-3 py-2 w-full border-gray-300 focus:outline-blue-600" %>
  </div>
  <div class="flex flex-col sm:flex-row gap-4">
    <div class="flex-1">
      <%= form.label :address, '‰ΩèÊâÄ', class: 'block font-semibold mb-1' %>
      <%= form.text_field :address, class: "block shadow-sm rounded-md border px-3 py-2 w-full border-gray-300 focus:outline-blue-600" %>
    </div>
  </div>
  <div>
     <%= form.label :timestart, 'ÊôÇÈñìÂ∏ØÔºàÈñãÂßãÔºâ', class: 'block font-semibold mb-1' %>
     <%= form.select :timestart, options_for_select((0..23).map { |h| ["#{h}:00", "#{h}:00"] } , selected: photo_spot.timestart&.strftime("%H:%M")), { include_blank: 'ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ' }, { class: "block shadow-sm rounded-md border px-3 py-2 w-full border-gray-300 focus:outline-blue-600" } %> 
  </div>
  <div>
      <%= form.label :timeend, 'ÊôÇÈñìÂ∏ØÔºàÁµÇ‰∫ÜÔºâ', class: 'block font-semibold mb-1' %>
      <%= form.select :timeend, options_for_select((0..23).map { |h| ["#{h}:00", "#{h}:00"] } , selected: photo_spot.timestart&.strftime("%H:%M")), { include_blank: 'ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ' }, { class: "block shadow-sm rounded-md border px-3 py-2 w-full border-gray-300 focus:outline-blue-600" } %> 
  </div>
  <div>
    <%= form.label :season, '„Åä„Åô„Åô„ÇÅ„ÅÆÂ≠£ÁØÄ', class: 'block font-semibold mb-1' %>
    <%= form.select :season, options_for_select([['Êò•', 'spring'], ['Â§è', 'summer'], ['Áßã', 'autumn'], ['ÂÜ¨', 'winter']], selected: photo_spot.season), { include_blank: 'ÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ' }, { class: "block shadow-sm rounded-md border px-3 py-2 w-full border-gray-300 focus:outline-blue-600" } %>
  <%# Á∑ØÂ∫¶„ÉªÁµåÂ∫¶„ÅÆÂÖ•Âäõ„Éï„Ç£„Éº„É´„Éâ %>
  <div class="flex flex-col sm:flex-row gap-4">
    <div class="flex-1">
      <%= form.label :latitude, 'Á∑ØÂ∫¶', class: 'block font-semibold mb-1' %>
      <%= form.text_field :latitude,
                          data: { map_target: 'latitudeInput', action: 'input->map#updateMarkerFromInput' },
                          class: "block shadow-sm rounded-md border px-3 py-2 w-full border-gray-300 focus:outline-blue-600" %>
    </div>
    <div class="flex-1">
      <%= form.label :longitude, 'ÁµåÂ∫¶', class: 'block font-semibold mb-1' %>
      <%= form.text_field :longitude,
                          data: { map_target: 'longitudeInput', action: 'input->map#updateMarkerFromInput' },
                          class: "block shadow-sm rounded-md border px-3 py-2 w-full border-gray-300 focus:outline-blue-600" %>
    </div>
  </div>
  <%# Âú∞Âõ≥„Ç®„É™„Ç¢Ôºà„Éá„Çπ„ÇØ„Éà„ÉÉ„ÉóÊôÇÔºâ %>
  <div class="relative h-96 lg:h-[600px] rounded-lg overflow-hidden shadow-lg">
    <div data-map-target="container" style="width: 100%; height: 100%;"></div>
    <button type="button"
                class="absolute top-3 right-3 bg-white border rounded-lg px-4 py-2 text-sm shadow-lg hover:bg-blue-50 z-10 focus:ring-2 focus:ring-blue-500"
                data-action="click->map#locate">
      üìç <%= t('views.photo_spots.index.current_location') %>
    </button>
  </div>
  <div>
    <%= form.label :detail, 'Ë™¨Êòé', class: 'block font-semibold mb-1' %>
    <%= form.text_area :detail, rows: 4, class: "block shadow-sm rounded-md border px-3 py-2 w-full border-gray-300 focus:outline-blue-600" %>
  </div>
  <div>
    <%= form.label :tags, '„Çø„Ç∞Ôºà„Ç´„É≥„ÉûÂå∫Âàá„ÇäÔºâ', class: 'block font-semibold mb-1' %>
    <%= form.text_field :tags, class: "block shadow-sm rounded-md border px-3 py-2 w-full border-gray-300 focus:outline-blue-600" %>
  </div>
  <div>
    <%= form.label :parking_flag, 'ÈßêËªäÂ†¥„ÅÆÊúâÁÑ°', class: 'block font-semibold mb-1' %>
    <%= form.text_field :parking_flag, class: "block shadow-sm rounded-md border px-3 py-2 w-full border-gray-300 focus:outline-blue-600" %>
  </div>
  <div>
    <%= form.label :images, 'ÁîªÂÉèÔºàÊúÄÂ§ß5Êûö„ÉªJPEG/PNG/GIFÔºâ', class: 'block font-semibold mb-1' %>
    <%= form.file_field :images, multiple: true, accept: 'image/jpeg,image/png,image/gif', class: "block border rounded px-2 py-1 w-full" %>
    <% if photo_spot.images.attached? %>
      <div class="flex flex-wrap gap-2 mt-2">
        <% photo_spot.images.each_with_index do |img, idx| %>
          <div class="relative group">
            <%= image_tag img.variant(resize_to_limit: [100,100]), class: "rounded shadow border w-24 h-24 object-cover", alt: photo_spot.name %>
            <label class="block text-xs text-center mt-1">
              <%= check_box_tag "photo_spot[remove_image_ids][]", img.id, false %> ÂâäÈô§
            </label>
          </div>
        <% end %>
      </div>
    <% end %>
  </div>
  <div class="flex flex-col sm:flex-row gap-2">
    <%= form.submit class: "rounded-md px-4 py-2 bg-blue-600 hover:bg-blue-500 text-white font-semibold w-full sm:w-auto" %>
  </div>
<% end %>